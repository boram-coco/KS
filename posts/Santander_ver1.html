<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.283">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="김보람">
<meta name="dcterms.date" content="2023-12-19">

<title>KS - [Kaggle] Santander Product Recommendation Competition_v1</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">KS</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../about.html" rel="" target="">
 <span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/" rel="" target=""><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com" rel="" target=""><i class="bi bi-twitter" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">[Kaggle] Santander Product Recommendation Competition_v1</h1>
                      </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>김보람 </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">December 19, 2023</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<section id="ref" class="level1">
<h1>ref</h1>
<p><a href="https://www.kaggle.com/competitions/santander-product-recommendation/overview">[Kaggle] Santander Product Recommendation Competition</a></p>
<p><a href="https://search.shopping.naver.com/book/catalog/32456287218?cat_id=50010921&amp;frm=PBOKPRO&amp;query=Kaggle+%EC%9A%B0%EC%8A%B9%EC%9E%91%EC%9C%BC%EB%A1%9C+%EB%B0%B0%EC%9A%B0%EB%8A%94+%EB%A8%B8%EC%8B%A0%EB%9F%AC%EB%8B%9D+%ED%83%90%EA%B5%AC%EC%83%9D%ED%99%9C&amp;NaPm=ct%3Dlqc0jf6g%7Cci%3D396ce898b798e1d48ca1cd8ba98df1eff456e2ef%7Ctr%3Dboknx%7Csn%3D95694%7Chk%3D88c5289207d6a57ad40b1dbeafa8e1394b37bce3">kaggle 우승작으로 배우는 머신러닝 탐구생활</a></p>
</section>
<section id="import" class="level1">
<h1>import</h1>
<div id="22df14af-3e18-4b08-9a0e-ef835fef05a7" class="cell" data-execution_count="36">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co">#---#</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> autogluon.multimodal <span class="im">import</span> MultiModalPredictor <span class="co"># from autogluon.tabular import TabularPredictor</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="co">#---#</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> warnings</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>warnings.filterwarnings(<span class="st">'ignore'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="data" class="level1">
<h1>data</h1>
<ul>
<li><p>부동산 계약금 지불, 부동산 자산 활용 등 재정적 의사결정을 돕기 위한 고객 맞춤형 제품 추천</p></li>
<li><p>문제 유형: Multi-class Classification</p></li>
<li><p>평가 척도: Mean Average Precision</p></li>
</ul>
<div id="e769042f-bebe-4a55-84ba-279e14f80851" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>kaggle competitions download <span class="op">-</span>c santander<span class="op">-</span>product<span class="op">-</span>recommendation</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Warning: Your Kaggle API key is readable by other users on this system! To fix this, you can run 'chmod 600 /home/coco/.kaggle/kaggle.json'
Downloading santander-product-recommendation.zip to /home/coco/Dropbox/Class/KS/posts
100%|████████████████████████████████████████| 228M/228M [00:11&lt;00:00, 24.7MB/s]
100%|████████████████████████████████████████| 228M/228M [00:11&lt;00:00, 21.6MB/s]</code></pre>
</div>
</div>
<div id="ee0d1402-17ac-47a1-8cd3-5c0bfbb3d3e4" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>unzip santander<span class="op">-</span>product<span class="op">-</span>recommendation.<span class="bu">zip</span> <span class="op">-</span>d data </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Archive:  santander-product-recommendation.zip
  inflating: data/sample_submission.csv.zip  
  inflating: data/test_ver2.csv.zip  
  inflating: data/train_ver2.csv.zip  </code></pre>
</div>
</div>
<div id="e199ffbd-4aa9-42a0-8c16-40096a105643" class="cell" data-tags="[]" data-execution_count="7">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>df_train <span class="op">=</span> pd.read_csv(<span class="st">'data/train_ver2.csv.zip'</span>)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>df_test <span class="op">=</span> pd.read_csv(<span class="st">'data/test_ver2.csv.zip'</span>)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>sample_submission <span class="op">=</span> pd.read_csv(<span class="st">'data/sample_submission.csv.zip'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="236f1b84-1213-478d-bcfa-e42607ae959f" class="cell" data-tags="[]" data-execution_count="8">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>rm <span class="op">-</span>rf data</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>rm nlp<span class="op">-</span>getting<span class="op">-</span>started.<span class="bu">zip</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>rm: cannot remove 'nlp-getting-started.zip': No such file or directory</code></pre>
</div>
</div>
<div id="025c3534-0113-411c-be8e-314b4c25b62a" class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>df_train.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="12">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">fecha_dato</th>
<th data-quarto-table-cell-role="th">ncodpers</th>
<th data-quarto-table-cell-role="th">ind_empleado</th>
<th data-quarto-table-cell-role="th">pais_residencia</th>
<th data-quarto-table-cell-role="th">sexo</th>
<th data-quarto-table-cell-role="th">age</th>
<th data-quarto-table-cell-role="th">fecha_alta</th>
<th data-quarto-table-cell-role="th">ind_nuevo</th>
<th data-quarto-table-cell-role="th">antiguedad</th>
<th data-quarto-table-cell-role="th">indrel</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">ind_hip_fin_ult1</th>
<th data-quarto-table-cell-role="th">ind_plan_fin_ult1</th>
<th data-quarto-table-cell-role="th">ind_pres_fin_ult1</th>
<th data-quarto-table-cell-role="th">ind_reca_fin_ult1</th>
<th data-quarto-table-cell-role="th">ind_tjcr_fin_ult1</th>
<th data-quarto-table-cell-role="th">ind_valo_fin_ult1</th>
<th data-quarto-table-cell-role="th">ind_viv_fin_ult1</th>
<th data-quarto-table-cell-role="th">ind_nomina_ult1</th>
<th data-quarto-table-cell-role="th">ind_nom_pens_ult1</th>
<th data-quarto-table-cell-role="th">ind_recibo_ult1</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>2015-01-28</td>
<td>1375586</td>
<td>N</td>
<td>ES</td>
<td>H</td>
<td>35</td>
<td>2015-01-12</td>
<td>0.0</td>
<td>6</td>
<td>1.0</td>
<td>...</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>2015-01-28</td>
<td>1050611</td>
<td>N</td>
<td>ES</td>
<td>V</td>
<td>23</td>
<td>2012-08-10</td>
<td>0.0</td>
<td>35</td>
<td>1.0</td>
<td>...</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>2015-01-28</td>
<td>1050612</td>
<td>N</td>
<td>ES</td>
<td>V</td>
<td>23</td>
<td>2012-08-10</td>
<td>0.0</td>
<td>35</td>
<td>1.0</td>
<td>...</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>2015-01-28</td>
<td>1050613</td>
<td>N</td>
<td>ES</td>
<td>H</td>
<td>22</td>
<td>2012-08-10</td>
<td>0.0</td>
<td>35</td>
<td>1.0</td>
<td>...</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>2015-01-28</td>
<td>1050614</td>
<td>N</td>
<td>ES</td>
<td>V</td>
<td>23</td>
<td>2012-08-10</td>
<td>0.0</td>
<td>35</td>
<td>1.0</td>
<td>...</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
</tr>
</tbody>
</table>

<p>5 rows × 48 columns</p>
</div>
</div>
</div>
<div id="f0caecb7-957b-4da7-9325-82bfdd008293" class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>df_train.info()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 13647309 entries, 0 to 13647308
Data columns (total 48 columns):
 #   Column                 Dtype  
---  ------                 -----  
 0   fecha_dato             object 
 1   ncodpers               int64  
 2   ind_empleado           object 
 3   pais_residencia        object 
 4   sexo                   object 
 5   age                    object 
 6   fecha_alta             object 
 7   ind_nuevo              float64
 8   antiguedad             object 
 9   indrel                 float64
 10  ult_fec_cli_1t         object 
 11  indrel_1mes            object 
 12  tiprel_1mes            object 
 13  indresi                object 
 14  indext                 object 
 15  conyuemp               object 
 16  canal_entrada          object 
 17  indfall                object 
 18  tipodom                float64
 19  cod_prov               float64
 20  nomprov                object 
 21  ind_actividad_cliente  float64
 22  renta                  float64
 23  segmento               object 
 24  ind_ahor_fin_ult1      int64  
 25  ind_aval_fin_ult1      int64  
 26  ind_cco_fin_ult1       int64  
 27  ind_cder_fin_ult1      int64  
 28  ind_cno_fin_ult1       int64  
 29  ind_ctju_fin_ult1      int64  
 30  ind_ctma_fin_ult1      int64  
 31  ind_ctop_fin_ult1      int64  
 32  ind_ctpp_fin_ult1      int64  
 33  ind_deco_fin_ult1      int64  
 34  ind_deme_fin_ult1      int64  
 35  ind_dela_fin_ult1      int64  
 36  ind_ecue_fin_ult1      int64  
 37  ind_fond_fin_ult1      int64  
 38  ind_hip_fin_ult1       int64  
 39  ind_plan_fin_ult1      int64  
 40  ind_pres_fin_ult1      int64  
 41  ind_reca_fin_ult1      int64  
 42  ind_tjcr_fin_ult1      int64  
 43  ind_valo_fin_ult1      int64  
 44  ind_viv_fin_ult1       int64  
 45  ind_nomina_ult1        float64
 46  ind_nom_pens_ult1      float64
 47  ind_recibo_ult1        int64  
dtypes: float64(8), int64(23), object(17)
memory usage: 4.9+ GB</code></pre>
</div>
</div>
<p><code>-</code> for loop함수: 모든 변수의 첫 5줄 미리보기</p>
<div id="59e962b3-742e-4a81-8e30-53dfa5b95b9b" class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> col <span class="kw">in</span> df_train.columns:</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">'</span><span class="sc">{}</span><span class="ch">\n</span><span class="st">'</span>.<span class="bu">format</span>(df_train[col].head()))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0    2015-01-28
1    2015-01-28
2    2015-01-28
3    2015-01-28
4    2015-01-28
Name: fecha_dato, dtype: object

0    1375586
1    1050611
2    1050612
3    1050613
4    1050614
Name: ncodpers, dtype: int64

0    N
1    N
2    N
3    N
4    N
Name: ind_empleado, dtype: object

0    ES
1    ES
2    ES
3    ES
4    ES
Name: pais_residencia, dtype: object

0    H
1    V
2    V
3    H
4    V
Name: sexo, dtype: object

0     35
1     23
2     23
3     22
4     23
Name: age, dtype: object

0    2015-01-12
1    2012-08-10
2    2012-08-10
3    2012-08-10
4    2012-08-10
Name: fecha_alta, dtype: object

0    0.0
1    0.0
2    0.0
3    0.0
4    0.0
Name: ind_nuevo, dtype: float64

0          6
1         35
2         35
3         35
4         35
Name: antiguedad, dtype: object

0    1.0
1    1.0
2    1.0
3    1.0
4    1.0
Name: indrel, dtype: float64

0    NaN
1    NaN
2    NaN
3    NaN
4    NaN
Name: ult_fec_cli_1t, dtype: object

0    1.0
1    1.0
2    1.0
3    1.0
4    1.0
Name: indrel_1mes, dtype: object

0    A
1    I
2    I
3    I
4    A
Name: tiprel_1mes, dtype: object

0    S
1    S
2    S
3    S
4    S
Name: indresi, dtype: object

0    N
1    S
2    N
3    N
4    N
Name: indext, dtype: object

0    NaN
1    NaN
2    NaN
3    NaN
4    NaN
Name: conyuemp, dtype: object

0    KHL
1    KHE
2    KHE
3    KHD
4    KHE
Name: canal_entrada, dtype: object

0    N
1    N
2    N
3    N
4    N
Name: indfall, dtype: object

0    1.0
1    1.0
2    1.0
3    1.0
4    1.0
Name: tipodom, dtype: float64

0    29.0
1    13.0
2    13.0
3    50.0
4    50.0
Name: cod_prov, dtype: float64

0         MALAGA
1    CIUDAD REAL
2    CIUDAD REAL
3       ZARAGOZA
4       ZARAGOZA
Name: nomprov, dtype: object

0    1.0
1    0.0
2    0.0
3    0.0
4    1.0
Name: ind_actividad_cliente, dtype: float64

0     87218.10
1     35548.74
2    122179.11
3    119775.54
4          NaN
Name: renta, dtype: float64

0     02 - PARTICULARES
1    03 - UNIVERSITARIO
2    03 - UNIVERSITARIO
3    03 - UNIVERSITARIO
4    03 - UNIVERSITARIO
Name: segmento, dtype: object

0    0
1    0
2    0
3    0
4    0
Name: ind_ahor_fin_ult1, dtype: int64

0    0
1    0
2    0
3    0
4    0
Name: ind_aval_fin_ult1, dtype: int64

0    1
1    1
2    1
3    0
4    1
Name: ind_cco_fin_ult1, dtype: int64

0    0
1    0
2    0
3    0
4    0
Name: ind_cder_fin_ult1, dtype: int64

0    0
1    0
2    0
3    0
4    0
Name: ind_cno_fin_ult1, dtype: int64

0    0
1    0
2    0
3    0
4    0
Name: ind_ctju_fin_ult1, dtype: int64

0    0
1    0
2    0
3    0
4    0
Name: ind_ctma_fin_ult1, dtype: int64

0    0
1    0
2    0
3    0
4    0
Name: ind_ctop_fin_ult1, dtype: int64

0    0
1    0
2    0
3    0
4    0
Name: ind_ctpp_fin_ult1, dtype: int64

0    0
1    0
2    0
3    1
4    0
Name: ind_deco_fin_ult1, dtype: int64

0    0
1    0
2    0
3    0
4    0
Name: ind_deme_fin_ult1, dtype: int64

0    0
1    0
2    0
3    0
4    0
Name: ind_dela_fin_ult1, dtype: int64

0    0
1    0
2    0
3    0
4    0
Name: ind_ecue_fin_ult1, dtype: int64

0    0
1    0
2    0
3    0
4    0
Name: ind_fond_fin_ult1, dtype: int64

0    0
1    0
2    0
3    0
4    0
Name: ind_hip_fin_ult1, dtype: int64

0    0
1    0
2    0
3    0
4    0
Name: ind_plan_fin_ult1, dtype: int64

0    0
1    0
2    0
3    0
4    0
Name: ind_pres_fin_ult1, dtype: int64

0    0
1    0
2    0
3    0
4    0
Name: ind_reca_fin_ult1, dtype: int64

0    0
1    0
2    0
3    0
4    0
Name: ind_tjcr_fin_ult1, dtype: int64

0    0
1    0
2    0
3    0
4    0
Name: ind_valo_fin_ult1, dtype: int64

0    0
1    0
2    0
3    0
4    0
Name: ind_viv_fin_ult1, dtype: int64

0    0.0
1    0.0
2    0.0
3    0.0
4    0.0
Name: ind_nomina_ult1, dtype: float64

0    0.0
1    0.0
2    0.0
3    0.0
4    0.0
Name: ind_nom_pens_ult1, dtype: float64

0    0
1    0
2    0
3    0
4    0
Name: ind_recibo_ult1, dtype: int64
</code></pre>
</div>
</div>
<ul>
<li><p>fecha_alta: 날짜 변수가 datetime이 아닌 object</p></li>
<li><p>age: object이므로 정수형 변환 필요</p></li>
<li><p>renta: 가구 총수입 나타내는 변수. NaN값 -&gt; 전처리 필요</p></li>
</ul>
<div id="68688953-80b1-4501-a449-729e2738bbd6" class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>df_train.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="15">
<pre><code>(13647309, 48)</code></pre>
</div>
</div>
<div id="343a4ab9-dea2-4409-9f67-d025de598371" class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>df_test.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="16">
<pre><code>(929615, 24)</code></pre>
</div>
</div>
<div id="0650e9fe-8069-43e5-8465-7d3d8c19932e" class="cell" data-execution_count="51">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="bu">set</span>(df_train) <span class="op">-</span> <span class="bu">set</span>(df_test)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="51">
<pre><code>{'ind_ahor_fin_ult1',
 'ind_aval_fin_ult1',
 'ind_cco_fin_ult1',
 'ind_cder_fin_ult1',
 'ind_cno_fin_ult1',
 'ind_ctju_fin_ult1',
 'ind_ctma_fin_ult1',
 'ind_ctop_fin_ult1',
 'ind_ctpp_fin_ult1',
 'ind_deco_fin_ult1',
 'ind_dela_fin_ult1',
 'ind_deme_fin_ult1',
 'ind_ecue_fin_ult1',
 'ind_fond_fin_ult1',
 'ind_hip_fin_ult1',
 'ind_nom_pens_ult1',
 'ind_nomina_ult1',
 'ind_plan_fin_ult1',
 'ind_pres_fin_ult1',
 'ind_reca_fin_ult1',
 'ind_recibo_ult1',
 'ind_tjcr_fin_ult1',
 'ind_valo_fin_ult1',
 'ind_viv_fin_ult1'}</code></pre>
</div>
</div>
<ul>
<li>고객이 신규로 구매할 제품을 예측하기</li>
</ul>
<div id="e351cd80-4b8b-472d-b421-8d0e33426301" class="cell" data-execution_count="53">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>sample_submission.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="53">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">ncodpers</th>
<th data-quarto-table-cell-role="th">added_products</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>15889</td>
<td>ind_tjcr_fin_ult1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>15890</td>
<td>ind_tjcr_fin_ult1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>15892</td>
<td>ind_tjcr_fin_ult1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>15893</td>
<td>ind_tjcr_fin_ult1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>15894</td>
<td>ind_tjcr_fin_ult1</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="eda" class="level1">
<h1>EDA</h1>
<section id="수치형-변수" class="level2">
<h2 class="anchored" data-anchor-id="수치형-변수">수치형 변수</h2>
<div id="7c5eb4e8-5696-4a5a-8fb7-d37ad8a26ced" class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>num_cols <span class="op">=</span> [col <span class="cf">for</span> col <span class="kw">in</span> df_train.columns[:<span class="dv">24</span>] <span class="cf">if</span> df_train[col].dtype <span class="kw">in</span> [<span class="st">'int64'</span>,<span class="st">'float64'</span>]]</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>df_train[num_cols].describe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="19">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">ncodpers</th>
<th data-quarto-table-cell-role="th">ind_nuevo</th>
<th data-quarto-table-cell-role="th">indrel</th>
<th data-quarto-table-cell-role="th">tipodom</th>
<th data-quarto-table-cell-role="th">cod_prov</th>
<th data-quarto-table-cell-role="th">ind_actividad_cliente</th>
<th data-quarto-table-cell-role="th">renta</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">count</td>
<td>1.364731e+07</td>
<td>1.361958e+07</td>
<td>1.361958e+07</td>
<td>13619574.0</td>
<td>1.355372e+07</td>
<td>1.361958e+07</td>
<td>1.085293e+07</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">mean</td>
<td>8.349042e+05</td>
<td>5.956184e-02</td>
<td>1.178399e+00</td>
<td>1.0</td>
<td>2.657147e+01</td>
<td>4.578105e-01</td>
<td>1.342543e+05</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">std</td>
<td>4.315650e+05</td>
<td>2.366733e-01</td>
<td>4.177469e+00</td>
<td>0.0</td>
<td>1.278402e+01</td>
<td>4.982169e-01</td>
<td>2.306202e+05</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">min</td>
<td>1.588900e+04</td>
<td>0.000000e+00</td>
<td>1.000000e+00</td>
<td>1.0</td>
<td>1.000000e+00</td>
<td>0.000000e+00</td>
<td>1.202730e+03</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">25%</td>
<td>4.528130e+05</td>
<td>0.000000e+00</td>
<td>1.000000e+00</td>
<td>1.0</td>
<td>1.500000e+01</td>
<td>0.000000e+00</td>
<td>6.871098e+04</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">50%</td>
<td>9.318930e+05</td>
<td>0.000000e+00</td>
<td>1.000000e+00</td>
<td>1.0</td>
<td>2.800000e+01</td>
<td>0.000000e+00</td>
<td>1.018500e+05</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">75%</td>
<td>1.199286e+06</td>
<td>0.000000e+00</td>
<td>1.000000e+00</td>
<td>1.0</td>
<td>3.500000e+01</td>
<td>1.000000e+00</td>
<td>1.559560e+05</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">max</td>
<td>1.553689e+06</td>
<td>1.000000e+00</td>
<td>9.900000e+01</td>
<td>1.0</td>
<td>5.200000e+01</td>
<td>1.000000e+00</td>
<td>2.889440e+07</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="범주형-변수" class="level2">
<h2 class="anchored" data-anchor-id="범주형-변수">범주형 변수</h2>
<div id="d33dc4d0-4152-4d1b-926e-4ec4710c438a" class="cell" data-execution_count="29">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>cat_cols <span class="op">=</span> [col <span class="cf">for</span> col <span class="kw">in</span> df_train.columns[:<span class="dv">24</span>] <span class="cf">if</span> df_train[col].dtype <span class="kw">in</span> [<span class="st">'object'</span>]]</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>df_train[cat_cols].describe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="29">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">fecha_dato</th>
<th data-quarto-table-cell-role="th">ind_empleado</th>
<th data-quarto-table-cell-role="th">pais_residencia</th>
<th data-quarto-table-cell-role="th">sexo</th>
<th data-quarto-table-cell-role="th">age</th>
<th data-quarto-table-cell-role="th">fecha_alta</th>
<th data-quarto-table-cell-role="th">antiguedad</th>
<th data-quarto-table-cell-role="th">ult_fec_cli_1t</th>
<th data-quarto-table-cell-role="th">indrel_1mes</th>
<th data-quarto-table-cell-role="th">tiprel_1mes</th>
<th data-quarto-table-cell-role="th">indresi</th>
<th data-quarto-table-cell-role="th">indext</th>
<th data-quarto-table-cell-role="th">conyuemp</th>
<th data-quarto-table-cell-role="th">canal_entrada</th>
<th data-quarto-table-cell-role="th">indfall</th>
<th data-quarto-table-cell-role="th">nomprov</th>
<th data-quarto-table-cell-role="th">segmento</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">count</td>
<td>13647309</td>
<td>13619575</td>
<td>13619575</td>
<td>13619505</td>
<td>13647309</td>
<td>13619575</td>
<td>13647309</td>
<td>24793</td>
<td>13497528.0</td>
<td>13497528</td>
<td>13619575</td>
<td>13619575</td>
<td>1808</td>
<td>13461183</td>
<td>13619575</td>
<td>13553718</td>
<td>13457941</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">unique</td>
<td>17</td>
<td>5</td>
<td>118</td>
<td>2</td>
<td>235</td>
<td>6756</td>
<td>507</td>
<td>223</td>
<td>13.0</td>
<td>5</td>
<td>2</td>
<td>2</td>
<td>2</td>
<td>162</td>
<td>2</td>
<td>52</td>
<td>3</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">top</td>
<td>2016-05-28</td>
<td>N</td>
<td>ES</td>
<td>V</td>
<td>23</td>
<td>2014-07-28</td>
<td>0</td>
<td>2015-12-24</td>
<td>1.0</td>
<td>I</td>
<td>S</td>
<td>N</td>
<td>N</td>
<td>KHE</td>
<td>N</td>
<td>MADRID</td>
<td>02 - PARTICULARES</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">freq</td>
<td>931453</td>
<td>13610977</td>
<td>13553710</td>
<td>7424252</td>
<td>542682</td>
<td>57389</td>
<td>134335</td>
<td>763</td>
<td>7277607.0</td>
<td>7304875</td>
<td>13553711</td>
<td>12974839</td>
<td>1791</td>
<td>4055270</td>
<td>13584813</td>
<td>4409600</td>
<td>7960220</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p><code>-</code> 고유값</p>
<div id="456f7ec7-dd2a-4920-a2cd-24d641da1aa5" class="cell" data-execution_count="30">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> col <span class="kw">in</span> cat_cols:</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>    uniq <span class="op">=</span> np.unique(df_train[col].astype(<span class="bu">str</span>))</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">'-'</span> <span class="op">*</span> <span class="dv">50</span>)</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">'# col </span><span class="sc">{}</span><span class="st">, n_uniq </span><span class="sc">{}</span><span class="st">, uniq </span><span class="sc">{}</span><span class="st">'</span>.<span class="bu">format</span>(col, <span class="bu">len</span>(uniq), uniq))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>--------------------------------------------------
# col fecha_dato, n_uniq 17, uniq ['2015-01-28' '2015-02-28' '2015-03-28' '2015-04-28' '2015-05-28'
 '2015-06-28' '2015-07-28' '2015-08-28' '2015-09-28' '2015-10-28'
 '2015-11-28' '2015-12-28' '2016-01-28' '2016-02-28' '2016-03-28'
 '2016-04-28' '2016-05-28']
--------------------------------------------------
# col ind_empleado, n_uniq 6, uniq ['A' 'B' 'F' 'N' 'S' 'nan']
--------------------------------------------------
# col pais_residencia, n_uniq 119, uniq ['AD' 'AE' 'AL' 'AO' 'AR' 'AT' 'AU' 'BA' 'BE' 'BG' 'BM' 'BO' 'BR' 'BY'
 'BZ' 'CA' 'CD' 'CF' 'CG' 'CH' 'CI' 'CL' 'CM' 'CN' 'CO' 'CR' 'CU' 'CZ'
 'DE' 'DJ' 'DK' 'DO' 'DZ' 'EC' 'EE' 'EG' 'ES' 'ET' 'FI' 'FR' 'GA' 'GB'
 'GE' 'GH' 'GI' 'GM' 'GN' 'GQ' 'GR' 'GT' 'GW' 'HK' 'HN' 'HR' 'HU' 'IE'
 'IL' 'IN' 'IS' 'IT' 'JM' 'JP' 'KE' 'KH' 'KR' 'KW' 'KZ' 'LB' 'LT' 'LU'
 'LV' 'LY' 'MA' 'MD' 'MK' 'ML' 'MM' 'MR' 'MT' 'MX' 'MZ' 'NG' 'NI' 'NL'
 'NO' 'NZ' 'OM' 'PA' 'PE' 'PH' 'PK' 'PL' 'PR' 'PT' 'PY' 'QA' 'RO' 'RS'
 'RU' 'SA' 'SE' 'SG' 'SK' 'SL' 'SN' 'SV' 'TG' 'TH' 'TN' 'TR' 'TW' 'UA'
 'US' 'UY' 'VE' 'VN' 'ZA' 'ZW' 'nan']
--------------------------------------------------
# col sexo, n_uniq 3, uniq ['H' 'V' 'nan']
--------------------------------------------------
# col age, n_uniq 219, uniq ['  2' '  3' '  4' '  5' '  6' '  7' '  8' '  9' ' 10' ' 11' ' 12' ' 13'
 ' 14' ' 15' ' 16' ' 17' ' 18' ' 19' ' 20' ' 21' ' 22' ' 23' ' 24' ' 25'
 ' 26' ' 27' ' 28' ' 29' ' 30' ' 31' ' 32' ' 33' ' 34' ' 35' ' 36' ' 37'
 ' 38' ' 39' ' 40' ' 41' ' 42' ' 43' ' 44' ' 45' ' 46' ' 47' ' 48' ' 49'
 ' 50' ' 51' ' 52' ' 53' ' 54' ' 55' ' 56' ' 57' ' 58' ' 59' ' 60' ' 61'
 ' 62' ' 63' ' 64' ' 65' ' 66' ' 67' ' 68' ' 69' ' 70' ' 71' ' 72' ' 73'
 ' 74' ' 75' ' 76' ' 77' ' 78' ' 79' ' 80' ' 81' ' 82' ' 83' ' 84' ' 85'
 ' 86' ' 87' ' 88' ' 89' ' 90' ' 91' ' 92' ' 93' ' 94' ' 95' ' 96' ' 97'
 ' 98' ' 99' ' NA' '10' '100' '101' '102' '103' '104' '105' '106' '107'
 '108' '109' '11' '110' '111' '112' '113' '114' '115' '116' '117' '12'
 '126' '127' '13' '14' '15' '16' '163' '164' '17' '18' '19' '2' '20' '21'
 '22' '23' '24' '25' '26' '27' '28' '29' '3' '30' '31' '32' '33' '34' '35'
 '36' '37' '38' '39' '4' '40' '41' '42' '43' '44' '45' '46' '47' '48' '49'
 '5' '50' '51' '52' '53' '54' '55' '56' '57' '58' '59' '6' '60' '61' '62'
 '63' '64' '65' '66' '67' '68' '69' '7' '70' '71' '72' '73' '74' '75' '76'
 '77' '78' '79' '8' '80' '81' '82' '83' '84' '85' '86' '87' '88' '89' '9'
 '90' '91' '92' '93' '94' '95' '96' '97' '98' '99']
--------------------------------------------------
# col fecha_alta, n_uniq 6757, uniq ['1995-01-16' '1995-01-17' '1995-01-23' ... '2016-05-30' '2016-05-31'
 'nan']
--------------------------------------------------
# col antiguedad, n_uniq 506, uniq ['      0' '      1' '      2' '      3' '      4' '      5' '      6'
 '      7' '      8' '      9' '     10' '     11' '     12' '     13'
 '     14' '     15' '     16' '     17' '     18' '     19' '     20'
 '     21' '     22' '     23' '     24' '     25' '     26' '     27'
 '     28' '     29' '     30' '     31' '     32' '     33' '     34'
 '     35' '     36' '     37' '     38' '     39' '     40' '     41'
 '     42' '     43' '     44' '     45' '     46' '     47' '     48'
 '     49' '     50' '     51' '     52' '     53' '     54' '     55'
 '     56' '     57' '     58' '     59' '     60' '     61' '     62'
 '     63' '     64' '     65' '     66' '     67' '     68' '     69'
 '     70' '     71' '     72' '     73' '     74' '     75' '     76'
 '     77' '     78' '     79' '     80' '     81' '     82' '     83'
 '     84' '     85' '     86' '     87' '     88' '     89' '     90'
 '     91' '     92' '     93' '     94' '     95' '     96' '     97'
 '     98' '     99' '     NA' '    100' '    101' '    102' '    103'
 '    104' '    105' '    106' '    107' '    108' '    109' '    110'
 '    111' '    112' '    113' '    114' '    115' '    116' '    117'
 '    118' '    119' '    120' '    121' '    122' '    123' '    124'
 '    125' '    126' '    127' '    128' '    129' '    130' '    131'
 '    132' '    133' '    134' '    135' '    136' '    137' '    138'
 '    139' '    140' '    141' '    142' '    143' '    144' '    145'
 '    146' '    147' '    148' '    149' '    150' '    151' '    152'
 '    153' '    154' '    155' '    156' '    157' '    158' '    159'
 '    160' '    161' '    162' '    163' '    164' '    165' '    166'
 '    167' '    168' '    169' '    170' '    171' '    172' '    173'
 '    174' '    175' '    176' '    177' '    178' '    179' '    180'
 '    181' '    182' '    183' '    184' '    185' '    186' '    187'
 '    188' '    189' '    190' '    191' '    192' '    193' '    194'
 '    195' '    196' '    197' '    198' '    199' '    200' '    201'
 '    202' '    203' '    204' '    205' '    206' '    207' '    208'
 '    209' '    210' '    211' '    212' '    213' '    214' '    215'
 '    216' '    217' '    218' '    219' '    220' '    221' '    222'
 '    223' '    224' '    225' '    226' '    227' '    228' '    229'
 '    230' '    231' '    232' '    233' '    234' '    235' '    236'
 '    237' '    238' '    239' '    240' '    241' '    242' '    243'
 '    244' '    245' '    246' '-999999' '0' '1' '10' '100' '101' '102'
 '103' '104' '105' '106' '107' '108' '109' '11' '110' '111' '112' '113'
 '114' '115' '116' '117' '118' '119' '12' '120' '121' '122' '123' '124'
 '125' '126' '127' '128' '129' '13' '130' '131' '132' '133' '134' '135'
 '136' '137' '138' '139' '14' '140' '141' '142' '143' '144' '145' '146'
 '147' '148' '149' '15' '150' '151' '152' '153' '154' '155' '156' '157'
 '158' '159' '16' '160' '161' '162' '163' '164' '165' '166' '167' '168'
 '169' '17' '170' '171' '172' '173' '174' '175' '176' '177' '178' '179'
 '18' '180' '181' '182' '183' '184' '185' '186' '187' '188' '189' '19'
 '190' '191' '192' '193' '194' '195' '196' '197' '198' '199' '2' '20'
 '200' '201' '202' '203' '204' '205' '206' '207' '208' '209' '21' '210'
 '211' '212' '213' '214' '215' '216' '217' '218' '219' '22' '220' '221'
 '222' '223' '224' '225' '226' '227' '228' '229' '23' '230' '231' '232'
 '233' '234' '235' '236' '237' '238' '239' '24' '240' '241' '242' '243'
 '244' '245' '246' '247' '248' '249' '25' '250' '251' '252' '253' '254'
 '255' '256' '26' '27' '28' '29' '3' '30' '31' '32' '33' '34' '35' '36'
 '37' '38' '39' '4' '40' '41' '42' '43' '44' '45' '46' '47' '48' '49' '5'
 '50' '51' '52' '53' '54' '55' '56' '57' '58' '59' '6' '60' '61' '62' '63'
 '64' '65' '66' '67' '68' '69' '7' '70' '71' '72' '73' '74' '75' '76' '77'
 '78' '79' '8' '80' '81' '82' '83' '84' '85' '86' '87' '88' '89' '9' '90'
 '91' '92' '93' '94' '95' '96' '97' '98' '99']
--------------------------------------------------
# col ult_fec_cli_1t, n_uniq 224, uniq ['2015-07-01' '2015-07-02' '2015-07-03' '2015-07-06' '2015-07-07'
 '2015-07-08' '2015-07-09' '2015-07-10' '2015-07-13' '2015-07-14'
 '2015-07-15' '2015-07-16' '2015-07-17' '2015-07-20' '2015-07-21'
 '2015-07-22' '2015-07-23' '2015-07-24' '2015-07-27' '2015-07-28'
 '2015-07-29' '2015-07-30' '2015-08-03' '2015-08-04' '2015-08-05'
 '2015-08-06' '2015-08-07' '2015-08-10' '2015-08-11' '2015-08-12'
 '2015-08-13' '2015-08-14' '2015-08-17' '2015-08-18' '2015-08-19'
 '2015-08-20' '2015-08-21' '2015-08-24' '2015-08-25' '2015-08-26'
 '2015-08-27' '2015-08-28' '2015-09-01' '2015-09-02' '2015-09-03'
 '2015-09-04' '2015-09-07' '2015-09-08' '2015-09-09' '2015-09-10'
 '2015-09-11' '2015-09-14' '2015-09-15' '2015-09-16' '2015-09-17'
 '2015-09-18' '2015-09-21' '2015-09-22' '2015-09-23' '2015-09-24'
 '2015-09-25' '2015-09-28' '2015-09-29' '2015-10-01' '2015-10-02'
 '2015-10-05' '2015-10-06' '2015-10-07' '2015-10-08' '2015-10-09'
 '2015-10-13' '2015-10-14' '2015-10-15' '2015-10-16' '2015-10-19'
 '2015-10-20' '2015-10-21' '2015-10-22' '2015-10-23' '2015-10-26'
 '2015-10-27' '2015-10-28' '2015-10-29' '2015-11-02' '2015-11-03'
 '2015-11-04' '2015-11-05' '2015-11-06' '2015-11-09' '2015-11-10'
 '2015-11-11' '2015-11-12' '2015-11-13' '2015-11-16' '2015-11-17'
 '2015-11-18' '2015-11-19' '2015-11-20' '2015-11-23' '2015-11-24'
 '2015-11-25' '2015-11-26' '2015-11-27' '2015-12-01' '2015-12-02'
 '2015-12-03' '2015-12-04' '2015-12-07' '2015-12-09' '2015-12-10'
 '2015-12-11' '2015-12-14' '2015-12-15' '2015-12-16' '2015-12-17'
 '2015-12-18' '2015-12-21' '2015-12-22' '2015-12-23' '2015-12-24'
 '2015-12-28' '2015-12-29' '2015-12-30' '2016-01-04' '2016-01-05'
 '2016-01-07' '2016-01-08' '2016-01-11' '2016-01-12' '2016-01-13'
 '2016-01-14' '2016-01-15' '2016-01-18' '2016-01-19' '2016-01-20'
 '2016-01-21' '2016-01-22' '2016-01-25' '2016-01-26' '2016-01-27'
 '2016-01-28' '2016-02-01' '2016-02-02' '2016-02-03' '2016-02-04'
 '2016-02-05' '2016-02-08' '2016-02-09' '2016-02-10' '2016-02-11'
 '2016-02-12' '2016-02-15' '2016-02-16' '2016-02-17' '2016-02-18'
 '2016-02-19' '2016-02-22' '2016-02-23' '2016-02-24' '2016-02-25'
 '2016-02-26' '2016-03-01' '2016-03-02' '2016-03-03' '2016-03-04'
 '2016-03-07' '2016-03-08' '2016-03-09' '2016-03-10' '2016-03-11'
 '2016-03-14' '2016-03-15' '2016-03-16' '2016-03-17' '2016-03-18'
 '2016-03-21' '2016-03-22' '2016-03-23' '2016-03-24' '2016-03-28'
 '2016-03-29' '2016-03-30' '2016-04-01' '2016-04-04' '2016-04-05'
 '2016-04-06' '2016-04-07' '2016-04-08' '2016-04-11' '2016-04-12'
 '2016-04-13' '2016-04-14' '2016-04-15' '2016-04-18' '2016-04-19'
 '2016-04-20' '2016-04-21' '2016-04-22' '2016-04-25' '2016-04-26'
 '2016-04-27' '2016-04-28' '2016-05-02' '2016-05-03' '2016-05-04'
 '2016-05-05' '2016-05-06' '2016-05-09' '2016-05-10' '2016-05-11'
 '2016-05-12' '2016-05-13' '2016-05-16' '2016-05-17' '2016-05-18'
 '2016-05-19' '2016-05-20' '2016-05-23' '2016-05-24' '2016-05-25'
 '2016-05-26' '2016-05-27' '2016-05-30' 'nan']
--------------------------------------------------
# col indrel_1mes, n_uniq 10, uniq ['1' '1.0' '2' '2.0' '3' '3.0' '4' '4.0' 'P' 'nan']
--------------------------------------------------
# col tiprel_1mes, n_uniq 6, uniq ['A' 'I' 'N' 'P' 'R' 'nan']
--------------------------------------------------
# col indresi, n_uniq 3, uniq ['N' 'S' 'nan']
--------------------------------------------------
# col indext, n_uniq 3, uniq ['N' 'S' 'nan']
--------------------------------------------------
# col conyuemp, n_uniq 3, uniq ['N' 'S' 'nan']
--------------------------------------------------
# col canal_entrada, n_uniq 163, uniq ['004' '007' '013' '025' 'K00' 'KAA' 'KAB' 'KAC' 'KAD' 'KAE' 'KAF' 'KAG'
 'KAH' 'KAI' 'KAJ' 'KAK' 'KAL' 'KAM' 'KAN' 'KAO' 'KAP' 'KAQ' 'KAR' 'KAS'
 'KAT' 'KAU' 'KAV' 'KAW' 'KAY' 'KAZ' 'KBB' 'KBD' 'KBE' 'KBF' 'KBG' 'KBH'
 'KBJ' 'KBL' 'KBM' 'KBN' 'KBO' 'KBP' 'KBQ' 'KBR' 'KBS' 'KBU' 'KBV' 'KBW'
 'KBX' 'KBY' 'KBZ' 'KCA' 'KCB' 'KCC' 'KCD' 'KCE' 'KCF' 'KCG' 'KCH' 'KCI'
 'KCJ' 'KCK' 'KCL' 'KCM' 'KCN' 'KCO' 'KCP' 'KCQ' 'KCR' 'KCS' 'KCT' 'KCU'
 'KCV' 'KCX' 'KDA' 'KDB' 'KDC' 'KDD' 'KDE' 'KDF' 'KDG' 'KDH' 'KDI' 'KDL'
 'KDM' 'KDN' 'KDO' 'KDP' 'KDQ' 'KDR' 'KDS' 'KDT' 'KDU' 'KDV' 'KDW' 'KDX'
 'KDY' 'KDZ' 'KEA' 'KEB' 'KEC' 'KED' 'KEE' 'KEF' 'KEG' 'KEH' 'KEI' 'KEJ'
 'KEK' 'KEL' 'KEM' 'KEN' 'KEO' 'KEQ' 'KES' 'KEU' 'KEV' 'KEW' 'KEY' 'KEZ'
 'KFA' 'KFB' 'KFC' 'KFD' 'KFE' 'KFF' 'KFG' 'KFH' 'KFI' 'KFJ' 'KFK' 'KFL'
 'KFM' 'KFN' 'KFP' 'KFR' 'KFS' 'KFT' 'KFU' 'KFV' 'KGC' 'KGN' 'KGU' 'KGV'
 'KGW' 'KGX' 'KGY' 'KHA' 'KHC' 'KHD' 'KHE' 'KHF' 'KHK' 'KHL' 'KHM' 'KHN'
 'KHO' 'KHP' 'KHQ' 'KHR' 'KHS' 'RED' 'nan']
--------------------------------------------------
# col indfall, n_uniq 3, uniq ['N' 'S' 'nan']
--------------------------------------------------
# col nomprov, n_uniq 53, uniq ['ALAVA' 'ALBACETE' 'ALICANTE' 'ALMERIA' 'ASTURIAS' 'AVILA' 'BADAJOZ'
 'BALEARS, ILLES' 'BARCELONA' 'BIZKAIA' 'BURGOS' 'CACERES' 'CADIZ'
 'CANTABRIA' 'CASTELLON' 'CEUTA' 'CIUDAD REAL' 'CORDOBA' 'CORUÑA, A'
 'CUENCA' 'GIPUZKOA' 'GIRONA' 'GRANADA' 'GUADALAJARA' 'HUELVA' 'HUESCA'
 'JAEN' 'LEON' 'LERIDA' 'LUGO' 'MADRID' 'MALAGA' 'MELILLA' 'MURCIA'
 'NAVARRA' 'OURENSE' 'PALENCIA' 'PALMAS, LAS' 'PONTEVEDRA' 'RIOJA, LA'
 'SALAMANCA' 'SANTA CRUZ DE TENERIFE' 'SEGOVIA' 'SEVILLA' 'SORIA'
 'TARRAGONA' 'TERUEL' 'TOLEDO' 'VALENCIA' 'VALLADOLID' 'ZAMORA' 'ZARAGOZA'
 'nan']
--------------------------------------------------
# col segmento, n_uniq 4, uniq ['01 - TOP' '02 - PARTICULARES' '03 - UNIVERSITARIO' 'nan']</code></pre>
</div>
</div>
</section>
<section id="데이터-분석" class="level2">
<h2 class="anchored" data-anchor-id="데이터-분석">데이터 분석</h2>
<ol type="1">
<li><p>fecha_dato: 년-월-일로 28일자를 기준으로 17개</p></li>
<li><p>ind_empleado: 결측치</p></li>
<li><p>pais_residencia: 나라(대문자 2개), 결측치</p></li>
<li><p>sexo: 결측치</p></li>
</ol>
<p>,, 결측치 핵 많음</p>
<table class="table">
<thead>
<tr class="header">
<th>변수명</th>
<th>내용</th>
<th>데이터 타입</th>
<th>특징</th>
<th>변수 아이디어</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>fecha_data</td>
<td>월별 날짜 데이터</td>
<td>object</td>
<td></td>
<td>년도, 월 데이터 별도 추출</td>
</tr>
<tr class="even">
<td>age</td>
<td>나이</td>
<td>obeject -&gt;int</td>
<td></td>
<td>나이데이터가 정수형이 아니므로 정제 필요</td>
</tr>
</tbody>
</table>
<blockquote class="blockquote">
<p>위 내용은 책에서 정리한 거고.. 추후 이렇게 정리하는 분석 방법이 필요</p>
</blockquote>
</section>
<section id="시각화" class="level2">
<h2 class="anchored" data-anchor-id="시각화">시각화</h2>
<div id="b2b3e156-f19f-44ce-a2b9-87a8e8146c98" class="cell" data-execution_count="40">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>skip_cols <span class="op">=</span> [<span class="st">'ncodpers'</span>, <span class="st">'renta'</span>] <span class="co"># 고객 고유 식별 번호, 총 수입 (고유값 많으므로 제거)</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> col <span class="kw">in</span> df_train.columns:</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> col <span class="kw">in</span> skip_cols:</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>        <span class="cf">continue</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">'-'</span> <span class="op">*</span> <span class="dv">50</span>)</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">'col:'</span>,col)</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>    f, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">20</span>,<span class="dv">15</span>))</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>    sns.countplot(x<span class="op">=</span>col, data<span class="op">=</span>df_train, alpha<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>    plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>--------------------------------------------------
col: fecha_dato
--------------------------------------------------
col: ind_empleado
--------------------------------------------------
col: pais_residencia
--------------------------------------------------
col: sexo
--------------------------------------------------
col: age
--------------------------------------------------
col: fecha_alta
--------------------------------------------------
col: ind_nuevo
--------------------------------------------------
col: antiguedad
--------------------------------------------------
col: indrel
--------------------------------------------------
col: ult_fec_cli_1t
--------------------------------------------------
col: indrel_1mes
--------------------------------------------------
col: tiprel_1mes
--------------------------------------------------
col: indresi
--------------------------------------------------
col: indext
--------------------------------------------------
col: conyuemp
--------------------------------------------------
col: canal_entrada
--------------------------------------------------
col: indfall
--------------------------------------------------
col: tipodom
--------------------------------------------------
col: cod_prov
--------------------------------------------------
col: nomprov
--------------------------------------------------
col: ind_actividad_cliente
--------------------------------------------------
col: segmento
--------------------------------------------------
col: ind_ahor_fin_ult1
--------------------------------------------------
col: ind_aval_fin_ult1
--------------------------------------------------
col: ind_cco_fin_ult1
--------------------------------------------------
col: ind_cder_fin_ult1
--------------------------------------------------
col: ind_cno_fin_ult1
--------------------------------------------------
col: ind_ctju_fin_ult1
--------------------------------------------------
col: ind_ctma_fin_ult1
--------------------------------------------------
col: ind_ctop_fin_ult1
--------------------------------------------------
col: ind_ctpp_fin_ult1
--------------------------------------------------
col: ind_deco_fin_ult1
--------------------------------------------------
col: ind_deme_fin_ult1
--------------------------------------------------
col: ind_dela_fin_ult1
--------------------------------------------------
col: ind_ecue_fin_ult1
--------------------------------------------------
col: ind_fond_fin_ult1
--------------------------------------------------
col: ind_hip_fin_ult1
--------------------------------------------------
col: ind_plan_fin_ult1
--------------------------------------------------
col: ind_pres_fin_ult1
--------------------------------------------------
col: ind_reca_fin_ult1
--------------------------------------------------
col: ind_tjcr_fin_ult1
--------------------------------------------------
col: ind_valo_fin_ult1
--------------------------------------------------
col: ind_viv_fin_ult1
--------------------------------------------------
col: ind_nomina_ult1
--------------------------------------------------
col: ind_nom_pens_ult1
--------------------------------------------------
col: ind_recibo_ult1</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="Santander_ver1_files/figure-html/cell-17-output-2.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="Santander_ver1_files/figure-html/cell-17-output-3.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="Santander_ver1_files/figure-html/cell-17-output-4.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="Santander_ver1_files/figure-html/cell-17-output-5.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="Santander_ver1_files/figure-html/cell-17-output-6.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="Santander_ver1_files/figure-html/cell-17-output-7.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="Santander_ver1_files/figure-html/cell-17-output-8.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="Santander_ver1_files/figure-html/cell-17-output-9.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="Santander_ver1_files/figure-html/cell-17-output-10.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="Santander_ver1_files/figure-html/cell-17-output-11.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="Santander_ver1_files/figure-html/cell-17-output-12.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="Santander_ver1_files/figure-html/cell-17-output-13.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="Santander_ver1_files/figure-html/cell-17-output-14.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="Santander_ver1_files/figure-html/cell-17-output-15.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="Santander_ver1_files/figure-html/cell-17-output-16.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="Santander_ver1_files/figure-html/cell-17-output-17.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="Santander_ver1_files/figure-html/cell-17-output-18.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="Santander_ver1_files/figure-html/cell-17-output-19.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="Santander_ver1_files/figure-html/cell-17-output-20.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="Santander_ver1_files/figure-html/cell-17-output-21.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="Santander_ver1_files/figure-html/cell-17-output-22.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="Santander_ver1_files/figure-html/cell-17-output-23.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="Santander_ver1_files/figure-html/cell-17-output-24.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="Santander_ver1_files/figure-html/cell-17-output-25.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="Santander_ver1_files/figure-html/cell-17-output-26.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="Santander_ver1_files/figure-html/cell-17-output-27.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="Santander_ver1_files/figure-html/cell-17-output-28.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="Santander_ver1_files/figure-html/cell-17-output-29.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="Santander_ver1_files/figure-html/cell-17-output-30.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="Santander_ver1_files/figure-html/cell-17-output-31.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="Santander_ver1_files/figure-html/cell-17-output-32.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="Santander_ver1_files/figure-html/cell-17-output-33.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="Santander_ver1_files/figure-html/cell-17-output-34.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="Santander_ver1_files/figure-html/cell-17-output-35.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="Santander_ver1_files/figure-html/cell-17-output-36.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="Santander_ver1_files/figure-html/cell-17-output-37.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="Santander_ver1_files/figure-html/cell-17-output-38.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="Santander_ver1_files/figure-html/cell-17-output-39.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="Santander_ver1_files/figure-html/cell-17-output-40.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="Santander_ver1_files/figure-html/cell-17-output-41.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="Santander_ver1_files/figure-html/cell-17-output-42.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="Santander_ver1_files/figure-html/cell-17-output-43.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="Santander_ver1_files/figure-html/cell-17-output-44.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="Santander_ver1_files/figure-html/cell-17-output-45.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="Santander_ver1_files/figure-html/cell-17-output-46.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="Santander_ver1_files/figure-html/cell-17-output-47.png" class="img-fluid"></p>
</div>
</div>
<section id="월별-금융-제품-보유-데이터-누적-막대-그래프-시각화" class="level3">
<h3 class="anchored" data-anchor-id="월별-금융-제품-보유-데이터-누적-막대-그래프-시각화">월별 금융 제품 보유 데이터 누적 막대 그래프 시각화</h3>
<div id="f862a306-a0f6-49ef-adee-ce9bea2f0875" class="cell" data-execution_count="48">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>label_over_time <span class="op">=</span> []</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(label_cols)):</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>    label_sum <span class="op">=</span> df_train.groupby([<span class="st">'fecha_dato'</span>])[label_cols[i]].agg(<span class="st">'sum'</span>)</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>    label_over_time.append(label_sum.tolist())</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>label_sum_over_time <span class="op">=</span> []</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(label_cols)):</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>    label_sum_over_time.append(np.asarray(label_over_time[i:]).<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">0</span>))</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>color_list <span class="op">=</span> [<span class="st">'#F5B7B1'</span>,<span class="st">'#D2B4DE'</span>,<span class="st">'#AED6F1'</span>,<span class="st">'#A2D9CE'</span>,<span class="st">'#ABEBC6'</span>,<span class="st">'#F9E79F'</span>,<span class="st">'#F5CBA7'</span>,<span class="st">'#CCD1D1'</span>]</span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>f, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">30</span>, <span class="dv">15</span>))</span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(label_cols)):</span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>    sns.barplot(x<span class="op">=</span>months, y<span class="op">=</span>label_sum_over_time[i], color <span class="op">=</span> color_list[i<span class="op">%</span><span class="dv">8</span>], alpha<span class="op">=</span><span class="fl">0.7</span>)</span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a>plt.legend([plt.Rectangle((<span class="dv">0</span>,<span class="dv">0</span>),<span class="dv">1</span>,<span class="dv">1</span>,fc<span class="op">=</span>color_list[i<span class="op">%</span><span class="dv">8</span>], edgecolor <span class="op">=</span> <span class="st">'none'</span>) <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(label_cols))], label_cols, loc<span class="op">=</span><span class="dv">1</span>, ncol <span class="op">=</span> <span class="dv">2</span>, prop<span class="op">=</span>{<span class="st">'size'</span>:<span class="dv">16</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="48">
<pre><code>&lt;matplotlib.legend.Legend at 0x7f1f78271070&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="Santander_ver1_files/figure-html/cell-18-output-2.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="누적-막대-그래프-상대값-시각화" class="level3">
<h3 class="anchored" data-anchor-id="누적-막대-그래프-상대값-시각화">누적 막대 그래프 상대값 시각화</h3>
<div id="aa9beae3-b44a-46f5-a948-15bc9e4e1fa5" class="cell" data-execution_count="49">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>label_sum_percent <span class="op">=</span> (label_sum_over_time <span class="op">/</span> (<span class="fl">1.</span><span class="op">*</span>np.asarray(label_sum_over_time).<span class="bu">max</span>(axis<span class="op">=</span><span class="dv">0</span>))) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>f, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">30</span>, <span class="dv">15</span>))</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(label_cols)):</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>    sns.barplot(x<span class="op">=</span>months, y<span class="op">=</span>label_sum_percent[i], color <span class="op">=</span> color_list[i<span class="op">%</span><span class="dv">8</span>], alpha<span class="op">=</span><span class="fl">0.7</span>)</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>plt.legend([plt.Rectangle((<span class="dv">0</span>,<span class="dv">0</span>),<span class="dv">1</span>,<span class="dv">1</span>,fc<span class="op">=</span>color_list[i<span class="op">%</span><span class="dv">8</span>], edgecolor <span class="op">=</span> <span class="st">'none'</span>) <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(label_cols))], <span class="op">\</span></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>           label_cols, loc<span class="op">=</span><span class="dv">1</span>, ncol <span class="op">=</span> <span class="dv">2</span>, prop<span class="op">=</span>{<span class="st">'size'</span>:<span class="dv">16</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="49">
<pre><code>&lt;matplotlib.legend.Legend at 0x7f1f770de610&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="Santander_ver1_files/figure-html/cell-19-output-2.png" class="img-fluid"></p>
</div>
</div>
<ul>
<li>상대값으로 보기 위해서 퍼센테이지 나눈거!</li>
</ul>
</section>
<section id="신규-구매-데이터-생성-및-시각화" class="level3">
<h3 class="anchored" data-anchor-id="신규-구매-데이터-생성-및-시각화">신규 구매 데이터 생성 및 시각화</h3>
<ul>
<li>책에서는 예측해야할 ’신규 구매’에 초점을 맞추고 있어서 새로운 데이터를 추출했다.—&gt; 일단 난 안할래 흠냐</li>
</ul>
<div id="e2d9b527-3c45-493f-8386-d9738a8c1c68" class="cell" data-tags="[]">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 제품 변수를 prods에 list형태로 저장한다</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>prods <span class="op">=</span> trn.columns[<span class="dv">24</span>:].tolist()</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 날짜를 숫자로 변환하는 함수이다. 2015-01-28은 1, 2016-06-28은 18로 변환된다</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> date_to_int(str_date):</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>    Y, M, D <span class="op">=</span> [<span class="bu">int</span>(a) <span class="cf">for</span> a <span class="kw">in</span> str_date.strip().split(<span class="st">"-"</span>)]</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>    int_date <span class="op">=</span> (<span class="bu">int</span>(Y) <span class="op">-</span> <span class="dv">2015</span>) <span class="op">*</span> <span class="dv">12</span> <span class="op">+</span> <span class="bu">int</span>(M)</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> int_date</span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a><span class="co"># 날짜를 숫자로 변환하여 int_date에 저장한다</span></span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>trn[<span class="st">'int_date'</span>] <span class="op">=</span> trn[<span class="st">'fecha_dato'</span>].<span class="bu">map</span>(date_to_int).astype(np.int8)</span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a><span class="co"># 데이터를 복사하고, int_date 날짜에 1을 더하여 lag를 생성한다. 변수명에 _prev를 추가한다.</span></span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a>trn_lag <span class="op">=</span> trn.copy()</span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a>trn_lag[<span class="st">'int_date'</span>] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a>trn_lag.columns <span class="op">=</span> [col <span class="op">+</span> <span class="st">'_prev'</span> <span class="cf">if</span> col <span class="kw">not</span> <span class="kw">in</span> [<span class="st">'ncodpers'</span>, <span class="st">'int_date'</span>] <span class="cf">else</span> col <span class="cf">for</span> col <span class="kw">in</span> trn.columns]</span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a><span class="co"># 원본 데이터와 lag 데이터를 ncodper와 int_date 기준으로 합친다. Lag 데이터의 int_date는 1 밀려있기 때문에, 저번달의 제품 정보가 삽입된다.</span></span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true" tabindex="-1"></a>df_trn <span class="op">=</span> trn.merge(trn_lag, on<span class="op">=</span>[<span class="st">'ncodpers'</span>,<span class="st">'int_date'</span>], how<span class="op">=</span><span class="st">'left'</span>)</span>
<span id="cb31-20"><a href="#cb31-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-21"><a href="#cb31-21" aria-hidden="true" tabindex="-1"></a><span class="co"># 메모리 효율을 위해 불필요한 변수를 메모리에서 제거한다</span></span>
<span id="cb31-22"><a href="#cb31-22" aria-hidden="true" tabindex="-1"></a><span class="kw">del</span> trn, trn_lag</span>
<span id="cb31-23"><a href="#cb31-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-24"><a href="#cb31-24" aria-hidden="true" tabindex="-1"></a><span class="co"># 저번달의 제품 정보가 존재하지 않을 경우를 대비하여 0으로 대체한다.</span></span>
<span id="cb31-25"><a href="#cb31-25" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> prod <span class="kw">in</span> prods:</span>
<span id="cb31-26"><a href="#cb31-26" aria-hidden="true" tabindex="-1"></a>    prev <span class="op">=</span> prod <span class="op">+</span> <span class="st">'_prev'</span></span>
<span id="cb31-27"><a href="#cb31-27" aria-hidden="true" tabindex="-1"></a>    df_trn[prev].fillna(<span class="dv">0</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb31-28"><a href="#cb31-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-29"><a href="#cb31-29" aria-hidden="true" tabindex="-1"></a><span class="co"># 원본 데이터에서의 제품 보유 여부 – lag데이터에서의 제품 보유 여부를 비교하여 신규 구매 변수 padd를 구한다</span></span>
<span id="cb31-30"><a href="#cb31-30" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> prod <span class="kw">in</span> prods:</span>
<span id="cb31-31"><a href="#cb31-31" aria-hidden="true" tabindex="-1"></a>    padd <span class="op">=</span> prod <span class="op">+</span> <span class="st">'_add'</span></span>
<span id="cb31-32"><a href="#cb31-32" aria-hidden="true" tabindex="-1"></a>    prev <span class="op">=</span> prod <span class="op">+</span> <span class="st">'_prev'</span></span>
<span id="cb31-33"><a href="#cb31-33" aria-hidden="true" tabindex="-1"></a>    df_trn[padd] <span class="op">=</span> ((df_trn[prod] <span class="op">==</span> <span class="dv">1</span>) <span class="op">&amp;</span> (df_trn[prev] <span class="op">==</span> <span class="dv">0</span>)).astype(np.int8)</span>
<span id="cb31-34"><a href="#cb31-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-35"><a href="#cb31-35" aria-hidden="true" tabindex="-1"></a><span class="co"># 신규 구매 변수만을 추출하여 labels에 저장한다.</span></span>
<span id="cb31-36"><a href="#cb31-36" aria-hidden="true" tabindex="-1"></a>add_cols <span class="op">=</span> [prod <span class="op">+</span> <span class="st">'_add'</span> <span class="cf">for</span> prod <span class="kw">in</span> prods]</span>
<span id="cb31-37"><a href="#cb31-37" aria-hidden="true" tabindex="-1"></a>labels <span class="op">=</span> df_trn[add_cols].copy()</span>
<span id="cb31-38"><a href="#cb31-38" aria-hidden="true" tabindex="-1"></a>labels.columns <span class="op">=</span> prods</span>
<span id="cb31-39"><a href="#cb31-39" aria-hidden="true" tabindex="-1"></a><span class="co">#labels.to_csv('../input/labels.csv', index=False)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="d623a3c0-5c4c-47bf-bc47-c9da8e2eae85" class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 코드 1-12. 신규 구매 누적 막대 그래프를 시각화하기</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="co">#labels = pd.read_csv('../input/labels.csv').astype(int)</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>fecha_dato <span class="op">=</span> trn[<span class="st">'fecha_dato'</span>]</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>labels[<span class="st">'date'</span>] <span class="op">=</span> fecha_dato.fecha_dato</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>months <span class="op">=</span> np.unique(fecha_dato.fecha_dato).tolist()</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>label_cols <span class="op">=</span> labels.columns.tolist()[:<span class="dv">24</span>]</span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>label_over_time <span class="op">=</span> []</span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(label_cols)):</span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>    label_over_time.append(labels.groupby([<span class="st">'date'</span>])[label_cols[i]].agg(<span class="st">'sum'</span>).tolist())</span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a>label_sum_over_time <span class="op">=</span> []</span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(label_cols)):</span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a>    label_sum_over_time.append(np.asarray(label_over_time[i:]).<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">0</span>))</span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a>color_list <span class="op">=</span> [<span class="st">'#F5B7B1'</span>,<span class="st">'#D2B4DE'</span>,<span class="st">'#AED6F1'</span>,<span class="st">'#A2D9CE'</span>,<span class="st">'#ABEBC6'</span>,<span class="st">'#F9E79F'</span>,<span class="st">'#F5CBA7'</span>,<span class="st">'#CCD1D1'</span>]</span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-20"><a href="#cb32-20" aria-hidden="true" tabindex="-1"></a>f, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">30</span>, <span class="dv">15</span>))</span>
<span id="cb32-21"><a href="#cb32-21" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(label_cols)):</span>
<span id="cb32-22"><a href="#cb32-22" aria-hidden="true" tabindex="-1"></a>    sns.barplot(x<span class="op">=</span>months, y<span class="op">=</span>label_sum_over_time[i], color <span class="op">=</span> color_list[i<span class="op">%</span><span class="dv">8</span>], alpha<span class="op">=</span><span class="fl">0.7</span>)</span>
<span id="cb32-23"><a href="#cb32-23" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb32-24"><a href="#cb32-24" aria-hidden="true" tabindex="-1"></a>plt.legend([plt.Rectangle((<span class="dv">0</span>,<span class="dv">0</span>),<span class="dv">1</span>,<span class="dv">1</span>,fc<span class="op">=</span>color_list[i<span class="op">%</span><span class="dv">8</span>], edgecolor <span class="op">=</span> <span class="st">'none'</span>) <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(label_cols))], label_cols, loc<span class="op">=</span><span class="dv">1</span>, ncol <span class="op">=</span> <span class="dv">2</span>, prop<span class="op">=</span>{<span class="st">'size'</span>:<span class="dv">16</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="15">
<pre><code>&lt;matplotlib.legend.Legend at 0x7fb5f6211550&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="Santander_ver1_files/figure-html/cell-21-output-2.png" class="img-fluid"></p>
</div>
</div>
<div id="887e6cac-e600-47b5-817e-2e14943e0088" class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 코드 1-13. 신규 구매 누적 막대 그래프를 상대값으로 시각화하기</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>label_sum_percent <span class="op">=</span> (label_sum_over_time <span class="op">/</span> (<span class="fl">1.</span><span class="op">*</span>np.asarray(label_sum_over_time).<span class="bu">max</span>(axis<span class="op">=</span><span class="dv">0</span>))) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>f, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">30</span>, <span class="dv">15</span>))</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(label_cols)):</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>    sns.barplot(x<span class="op">=</span>months, y<span class="op">=</span>label_sum_percent[i], color <span class="op">=</span> color_list[i<span class="op">%</span><span class="dv">8</span>], alpha<span class="op">=</span><span class="fl">0.7</span>)</span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>plt.legend([plt.Rectangle((<span class="dv">0</span>,<span class="dv">0</span>),<span class="dv">1</span>,<span class="dv">1</span>,fc<span class="op">=</span>color_list[i<span class="op">%</span><span class="dv">8</span>], edgecolor <span class="op">=</span> <span class="st">'none'</span>) <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(label_cols))], <span class="op">\</span></span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>           label_cols, loc<span class="op">=</span><span class="dv">1</span>, ncol <span class="op">=</span> <span class="dv">2</span>, prop<span class="op">=</span>{<span class="st">'size'</span>:<span class="dv">16</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="16">
<pre><code>&lt;matplotlib.legend.Legend at 0x7fb5f682a898&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="Santander_ver1_files/figure-html/cell-22-output-2.png" class="img-fluid"></p>
</div>
</div>


</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        for (let i = 0; i < 2; i++) {
          container.appendChild(note.children[i].cloneNode(true));
        }
        return container.innerHTML
      } else {
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      return note.innerHTML;
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>